(function(n){n(function(){function l(t){var u=n("ul#RecentlyUsedLinkedUsers"),i,r;n.each(t.items,function(n,t){t.shownUserName=app.getShownLinkedUserName(t)});t.hasLinkedUsers=function(){return this.items.length>0};i=n("#linkedAccountsSubMenuTemplate").html();Mustache.parse(i);r=Mustache.render(i,t);u.html(r)}function a(n,t){abp.ajax({url:abp.appPath+"Account/SwitchToLinkedAccount",data:JSON.stringify({targetUserId:n,targetTenantId:t})})}function v(){n("#setAllNotificationsAsReadLink").click(function(n){n.preventDefault();n.stopPropagation();t.setAllAsRead(function(){i()})});n(".set-notification-as-read").click(function(r){r.preventDefault();r.stopPropagation();var u=n(this).attr("data-notification-id");u&&t.setAsRead(u,function(){i()})});n("#openNotificationSettingsModalLink").click(function(n){n.preventDefault();n.stopPropagation();t.openSettingsModal()})}function i(){h.getUserNotifications({maxResultCount:3}).done(function(i){var u,r,f;i.notifications=[];n.each(i.items,function(n,r){i.notifications.push(t.format(r))});u=n("#header_notification_bar");r=n("#headerNotificationBarTemplate").html();Mustache.parse(r);f=Mustache.render(r,i);u.html(f);v()})}function y(){i();s()}var r,u,f,e,t,h;n("#UserProfileBackToMyAccountButton").click(function(n){n.preventDefault();abp.ajax({url:abp.appPath+"Account/BackToImpersonator"})});r=new app.ModalManager({viewUrl:abp.appPath+"Admin/Profile/MySettingsModal",scriptUrl:abp.appPath+"view-resources/Areas/Admin/Views/Profile/_MySettingsModal.js",modalClass:"MySettingsModal"});n("#UserProfileMySettingsLink").click(function(n){n.preventDefault();r.open()});u=new app.ModalManager({viewUrl:abp.appPath+"Admin/Profile/ChangePasswordModal",scriptUrl:abp.appPath+"view-resources/Areas/Admin/Views/Profile/_ChangePasswordModal.js",modalClass:"ChangePasswordModal"});n("#UserProfileChangePasswordLink").click(function(n){n.preventDefault();u.open()});f=new app.ModalManager({viewUrl:abp.appPath+"Admin/Profile/ChangePictureModal",scriptUrl:abp.appPath+"view-resources/Areas/Admin/Views/Profile/_ChangePictureModal.js",modalClass:"ChangeProfilePictureModal"});n("#UserProfileChangePictureLink").click(function(n){n.preventDefault();f.open()});e=new app.ModalManager({viewUrl:abp.appPath+"Admin/Users/LoginAttemptsModal",scriptUrl:abp.appPath+"view-resources/Areas/Admin/Views/Users/_LoginAttemptsModal.js",modalClass:"LoginAttemptsModal"});n("#ShowLoginAttemptsLink").click(function(n){n.preventDefault();e.open()});var c=abp.services.app.userLink,o=new app.ModalManager({viewUrl:abp.appPath+"Admin/Profile/LinkedAccountsModal",scriptUrl:abp.appPath+"view-resources/Areas/Admin/Views/Profile/_LinkedAccountsModal.js",modalClass:"LinkedAccountsModal"}),s=function(){c.getRecentlyUsedLinkedUsers().done(function(t){l(t);n("#ManageLinkedAccountsLink").click(function(n){n.preventDefault();o.open()});n(".recently-linked-user").click(function(t){t.preventDefault();var i=n(this).attr("data-user-id"),r=n(this).attr("data-tenant-id");i&&a(i,r)})})};o.onClose(function(){s()});t=new app.UserNotificationHelper;h=abp.services.app.notification;abp.event.on("abp.notifications.received",function(n){t.show(n);i()});abp.event.on("app.notifications.refresh",function(){i()});abp.event.on("app.notifications.read",function(){i()});abp.event.on("app.chat.unreadMessageCountChanged",function(t){t?n("#UnreadChatMessageCount").removeClass("hidden"):n("#UnreadChatMessageCount").addClass("hidden");n("#UnreadChatMessageCount").html(t)});y()})})(jQuery);