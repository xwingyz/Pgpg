(function(){$(function(){function u(n){return n.state==="READ"?"notification-read":""}function t(){r.jtable("load",{state:i.val()})}function e(t,i){n.setAsRead(t.id,function(){i&&i()})}function o(){n.setAllAsRead(function(){t()})}function s(){n.openSettingsModal()}var r=$("#NotificationsTable"),f=abp.services.app.notification,i=$("#TargetValueFilterSelectionCombobox"),n;i.selectpicker();n=new app.UserNotificationHelper;r.jtable({title:app.localize("Notifications"),paging:!0,sorting:!0,multiSorting:!0,actions:{listAction:{method:f.getUserNotifications}},fields:{id:{key:!0,list:!1},actions:{title:app.localize("Actions"),width:"10%",sorting:!1,listClass:"text-center",display:function(t){var r=$("<span><\/span>"),i=$('<button class="btn btn-xs btn-primary blue" title="'+app.localize("SetAsRead")+'"><\/button>').click(function(n){n.preventDefault();e(t.record,function(){i.find("i").removeClass("fa-circle-o").addClass("fa-check");i.attr("disabled","disabled")})}).appendTo(r),u=$('<i class="fa" >').appendTo(i),f=n.format(t.record).state;return f==="READ"&&(i.attr("disabled","disabled"),u.addClass("fa-check")),f==="UNREAD"&&u.addClass("fa-circle-o"),r}},notification:{title:app.localize("Notification"),width:"70%",display:function(t){var i=n.format(t.record,!1),r=u(i);return i.url?$('<a href="'+i.url+'" class="'+r+'">'+abp.utils.truncateStringWithPostfix(i.text,120)+"<\/a>"):$('<span title="'+i.text+'" class="'+r+'">'+abp.utils.truncateStringWithPostfix(i.text,120)+"<\/span>")}},creationTime:{title:app.localize("CreationTime"),width:"20%",display:function(t){var i=n.format(t.record),r=u(i);return $('<span title="'+moment(t.record.notification.creationTime).format("llll")+'" class="'+r+'">'+i.timeAgo+"<\/span> &nbsp;")}}}});i.change(function(){t()});$("#RefreshNotificationTableButton").click(function(n){n.preventDefault();t()});$("#btnOpenNotificationSettingsModal").click(function(){s()});$("#btnSetAllNotificationsAsRead").click(function(n){n.preventDefault();o()});t()})})();