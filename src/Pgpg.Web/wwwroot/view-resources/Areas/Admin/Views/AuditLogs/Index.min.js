(function(n){n(function(){function e(){var r={};return i.serializeArray().map(function(n){r[abp.utils.toCamelCase(n.name)]=n.value}),n.extend(r,t)}function r(){u.jtable("load",e())}function o(n){try{var t=JSON.parse(n);return JSON.stringify(t,null,4)}catch(i){return n}}function s(t){n("#AuditLogDetailModal_UserName").html(t.userName);n("#AuditLogDetailModal_ClientIpAddress").html(t.clientIpAddress);n("#AuditLogDetailModal_ClientName").html(t.clientName);n("#AuditLogDetailModal_BrowserInfo").html(t.browserInfo);n("#AuditLogDetailModal_ServiceName").html(t.serviceName);n("#AuditLogDetailModal_MethodName").html(t.methodName);n("#AuditLogDetailModal_ExecutionTime").html(moment(t.executionTime).fromNow()+" ("+moment(t.executionTime).format("YYYY-MM-DD hh:mm:ss")+")");n("#AuditLogDetailModal_Duration").html(app.localize("Xms",t.executionDuration));n("#AuditLogDetailModal_Parameters").html(o(t.parameters));t.impersonatorUserId?n("#AuditLogDetailModal_ImpersonatorInfo").show():n("#AuditLogDetailModal_ImpersonatorInfo").hide();t.exception?(n("#AuditLogDetailModal_Success").hide(),n("#AuditLogDetailModal_Exception").show(),n("#AuditLogDetailModal_Exception").html(t.exception)):(n("#AuditLogDetailModal_Exception").hide(),n("#AuditLogDetailModal_Success").show());t.customData?(n("#AuditLogDetailModal_CustomData_None").hide(),n("#AuditLogDetailModal_CustomData").show(),n("#AuditLogDetailModal_CustomData").html(t.customData)):(n("#AuditLogDetailModal_CustomData").hide(),n("#AuditLogDetailModal_CustomData_None").show());n("#AuditLogDetailModal").modal("show")}var u=n("#AuditLogsTable"),i=n("#AuditLogFilterForm"),f=abp.services.app.auditLog,t={startDate:moment().startOf("day"),endDate:moment().endOf("day")};i.find("input.date-range-picker").daterangepicker(n.extend(!0,app.createDateRangePickerOptions(),t),function(n,i){t.startDate=n.format("YYYY-MM-DDT00:00:00Z");t.endDate=i.format("YYYY-MM-DDT23:59:59.999Z")});u.jtable({title:app.localize("AuditLogs"),paging:!0,sorting:!0,multiSorting:!0,actions:{listAction:{method:f.getAuditLogs}},fields:{id:{key:!0,list:!1},actions:{title:"",width:"5%",sorting:!1,display:function(t){var i=n('<div class="text-center"><\/div>');return i.append('<button class="btn btn-default btn-xs"><i class="fa fa-search"><\/i><\/button>').click(function(){s(t.record)}),i}},exception:{title:"",width:"5%",sorting:!1,display:function(t){var i=n('<div class="text-center"><\/div>');return t.record.exception?i.append('<i class="fa fa-warning font-yellow-gold"><\/i>'):i.append('<i class="fa fa-check-circle font-green"><\/i>'),i}},executionTime:{title:app.localize("Time"),width:"13%",display:function(n){return moment(n.record.executionTime).format("YYYY-MM-DD HH:mm:ss")}},userName:{title:app.localize("UserName"),width:"10%"},serviceName:{title:app.localize("Service"),width:"17%",sorting:!1},methodName:{title:app.localize("Action"),width:"10%",sorting:!1},executionDuration:{title:app.localize("Duration"),width:"5%",display:function(n){return app.localize("Xms",n.record.executionDuration)}},clientIpAddress:{title:app.localize("IpAddress"),width:"10%",sorting:!1},clientName:{title:app.localize("Client"),width:"10%",sorting:!1},browserInfo:{title:app.localize("Browser"),width:"15%",sorting:!1}}});r();n("#RefreshAuditLogsButton").click(function(n){n.preventDefault();r()});n("#ExportAuditLogsToExcelButton").click(function(n){n.preventDefault();f.getAuditLogsToExcel(e()).done(function(n){app.downloadTempFile(n)})});n("#ShowAdvancedFiltersSpan").click(function(){n("#ShowAdvancedFiltersSpan").hide();n("#HideAdvancedFiltersSpan").show();n("#AdvacedAuditFiltersArea").slideDown()});n("#HideAdvancedFiltersSpan").click(function(){n("#HideAdvancedFiltersSpan").hide();n("#ShowAdvancedFiltersSpan").show();n("#AdvacedAuditFiltersArea").slideUp()});i.keydown(function(n){n.which===13&&(n.preventDefault(),r())})})})(jQuery);